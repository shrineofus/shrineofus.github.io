<!-- 📖 書本按鈕 -->
<button class="book-toggle-btn" id="open-book">📖</button>

<!-- 📚 書本全螢幕容器 -->
<div class="book-overlay" id="book-overlay">
  <div class="fullscreen-book">
    <h2>命運日記</h2>
    <div id="fullscreen-history"></div>
    <button class="toggle-btn" id="close-book">關閉命運之書</button>
  </div>
</div>

<script>
  const bookBtn = document.getElementById('open-book');
  const overlay = document.getElementById('book-overlay');
  const closeBtn = document.getElementById('close-book');
  const fullscreenContainer = document.getElementById('fullscreen-history');

  bookBtn.addEventListener('click', () => {
    overlay.classList.add('book-open');
    renderFullscreenHistory();
  });

  closeBtn.addEventListener('click', () => {
    overlay.classList.remove('book-open');
  });

  function renderFullscreenHistory() {
    const log = JSON.parse(localStorage.getItem("drawHistory") || "[]");
    const grouped = {};

    log.forEach(entry => {
      const date = entry.time.split(',')[0];
      if (!grouped[date]) grouped[date] = [];
      grouped[date].push(entry);
    });

    fullscreenContainer.innerHTML = Object.entries(grouped).map(([date, entries]) => `
      <div class="history-day">
        <h3>${date}</h3>
        ${entries.map(item => `
          <div class="history-entry">
            <p><strong>【${item.type}】${item.title}｜${item.orientation}</strong></p>
            <p>🔮 ${item.spell}</p>
            <p>${item.description}</p>
          </div>
        `).join('')}
      </div>
    `).join('');
  }
</script>


